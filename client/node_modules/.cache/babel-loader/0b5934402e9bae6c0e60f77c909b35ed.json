{"ast":null,"code":"import _slicedToArray from\"/Users/adamwatt/Desktop/JavaScriptProjects/React-practice/e-commerce/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{createRef,Fragment,useEffect,useState}from\"react\";import{connect}from\"react-redux\";import{removeProductFromCart,updateQuantity,loadUserCart}from\"../../actions\";// eslint-disable-next-line\nimport css from\"../../css/shoppingCartCard.css\";var ShoppingCartCard=function ShoppingCartCard(_ref){var cart=_ref.cart,removeProductFromCart=_ref.removeProductFromCart,loadUserCart=_ref.loadUserCart,updateQuantity=_ref.updateQuantity,isAuthenticated=_ref.isAuthenticated;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),itemDelete=_useState2[0],setItemDelete=_useState2[1];useEffect(function(){if(isAuthenticated){loadUserCart();}//eslint-disable-next-line\n},[itemDelete]);var priceOfItems=[null];cart.forEach(function(item){var totalEach=item.price*item.quantity;priceOfItems.push(totalEach);});var reducer=function reducer(accumulator,currentValue){return accumulator+currentValue;};var totalOfCart=priceOfItems.reduce(reducer);function decimalAdjust(type,value,exp){// If the exp is undefined or zero...\nif(typeof exp===\"undefined\"||+exp===0){return Math[type](value);}value=+value;exp=+exp;// If the value is not a number or the exp is not an integer...\nif(isNaN(value)||!(typeof exp===\"number\"&&exp%1===0)){return NaN;}// Shift\nvalue=value.toString().split(\"e\");value=Math[type](+(value[0]+\"e\"+(value[1]?+value[1]-exp:-exp)));// Shift back\nvalue=value.toString().split(\"e\");return+(value[0]+\"e\"+(value[1]?+value[1]+exp:exp));}// Decimal round\nvar round10=function round10(value,exp){return decimalAdjust(\"round\",value,exp);};var grandTotal=round10(totalOfCart,-2);// this creates an array of all the refs and stores them to an array for each item in cart\nvar refs=Array.from(cart,function(){return/*#__PURE__*/createRef(null);});// this handler loops through the refs and checks that they match the delete button's data-key then removes the item from the dom and cart\nvar deleteFromCart=function deleteFromCart(e){refs.forEach(function(ref){if(ref.current.getAttribute(\"value\")===e.target.getAttribute(\"data-delete\")){removeProductFromCart(ref.current.getAttribute(\"value\"),ref.current.getAttribute(\"id\"));setItemDelete(!itemDelete);}});};var renderOptions=function renderOptions(cartItemQuantity){var options=[];for(var i=1;i<=20;i++){options.push(/*#__PURE__*/_jsxs(\"option\",{value:i,children:[\"Qty: \",i]},[i]));}return options;};var _onChange=function onChange(e){refs.forEach(function(ref){if(ref.current.getAttribute(\"value\")===e.target.getAttribute(\"data-select\")){updateQuantity({_id:ref.current.getAttribute(\"id\"),id:+ref.current.getAttribute(\"value\"),quantity:+e.target.value});console.log(ref.current.getAttribute(\"id\"));}});};var renderItems=function renderItems(){return cart.map(function(cartItem,i){return/*#__PURE__*/_jsxs(\"div\",{id:cartItem._id,ref:refs[i],value:cartItem.id,className:\"cart-card\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"cart-card__img\",src:cartItem.image,alt:\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-card__body\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"cart-card__title\",children:cartItem.title}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"$\",cartItem.price]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-card__button-group\",children:[/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsx(\"select\",{onChange:function onChange(e){return _onChange(e);},defaultValue:cartItem.quantity,\"data-select\":cartItem.id,name:\"Quantity\",children:renderOptions(cartItem.quantity)})}),/*#__PURE__*/_jsx(\"span\",{onClick:deleteFromCart,\"data-delete\":cartItem.id,className:\"cart-card__button-group-btn ml-1\",children:\"Delete Item\"})]})]})]},cartItem.id);});};var emptyCart=function emptyCart(){return/*#__PURE__*/_jsx(\"div\",{className:\"flex-center\",children:\"Your shopping cart is empty\"});};return/*#__PURE__*/_jsx(Fragment,{children:grandTotal===0?/*#__PURE__*/_jsx(Fragment,{children:emptyCart()}):/*#__PURE__*/_jsxs(\"div\",{className:\"shopping-cart-card-container mb-1\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"shopping-cart-title\",children:\"Shopping Cart\"}),renderItems(),/*#__PURE__*/_jsxs(\"h1\",{className:\"subtotal ml-a\",children:[\"Subtotal: $\",grandTotal]})]})});};var mapStateToProps=function mapStateToProps(state){return{cart:state.cartItems.cart,isAuthenticated:state.authUser.isAuthenticated};};export default connect(mapStateToProps,{removeProductFromCart:removeProductFromCart,updateQuantity:updateQuantity,loadUserCart:loadUserCart})(ShoppingCartCard);","map":{"version":3,"sources":["/Users/adamwatt/Desktop/JavaScriptProjects/React-practice/e-commerce/client/src/components/shoppingCart/ShoppingCartCard.js"],"names":["React","createRef","Fragment","useEffect","useState","connect","removeProductFromCart","updateQuantity","loadUserCart","css","ShoppingCartCard","cart","isAuthenticated","itemDelete","setItemDelete","priceOfItems","forEach","item","totalEach","price","quantity","push","reducer","accumulator","currentValue","totalOfCart","reduce","decimalAdjust","type","value","exp","Math","isNaN","NaN","toString","split","round10","grandTotal","refs","Array","from","deleteFromCart","e","ref","current","getAttribute","target","renderOptions","cartItemQuantity","options","i","onChange","_id","id","console","log","renderItems","map","cartItem","image","title","emptyCart","mapStateToProps","state","cartItems","authUser"],"mappings":"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","sourcesContent":["import React, { createRef, Fragment, useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport {\n  removeProductFromCart,\n  updateQuantity,\n  loadUserCart,\n} from \"../../actions\";\n\n// eslint-disable-next-line\nimport css from \"../../css/shoppingCartCard.css\";\n\nconst ShoppingCartCard = ({\n  cart,\n  removeProductFromCart,\n  loadUserCart,\n  updateQuantity,\n  isAuthenticated,\n}) => {\n  const [itemDelete, setItemDelete] = useState(true);\n\n  useEffect(() => {\n    if (isAuthenticated) {\n      loadUserCart();\n    }\n    //eslint-disable-next-line\n  }, [itemDelete]);\n\n  const priceOfItems = [null];\n\n  cart.forEach((item) => {\n    const totalEach = item.price * item.quantity;\n    priceOfItems.push(totalEach);\n  });\n\n  const reducer = (accumulator, currentValue) => accumulator + currentValue;\n\n  const totalOfCart = priceOfItems.reduce(reducer);\n\n  function decimalAdjust(type, value, exp) {\n    // If the exp is undefined or zero...\n    if (typeof exp === \"undefined\" || +exp === 0) {\n      return Math[type](value);\n    }\n    value = +value;\n    exp = +exp;\n    // If the value is not a number or the exp is not an integer...\n    if (isNaN(value) || !(typeof exp === \"number\" && exp % 1 === 0)) {\n      return NaN;\n    }\n    // Shift\n    value = value.toString().split(\"e\");\n    value = Math[type](+(value[0] + \"e\" + (value[1] ? +value[1] - exp : -exp)));\n    // Shift back\n    value = value.toString().split(\"e\");\n    return +(value[0] + \"e\" + (value[1] ? +value[1] + exp : exp));\n  }\n\n  // Decimal round\n  const round10 = (value, exp) => decimalAdjust(\"round\", value, exp);\n\n  const grandTotal = round10(totalOfCart, -2);\n\n  // this creates an array of all the refs and stores them to an array for each item in cart\n  const refs = Array.from(cart, () => createRef(null));\n\n  // this handler loops through the refs and checks that they match the delete button's data-key then removes the item from the dom and cart\n  const deleteFromCart = (e) => {\n    refs.forEach((ref) => {\n      if (\n        ref.current.getAttribute(\"value\") ===\n        e.target.getAttribute(\"data-delete\")\n      ) {\n        removeProductFromCart(\n          ref.current.getAttribute(\"value\"),\n          ref.current.getAttribute(\"id\")\n        );\n        setItemDelete(!itemDelete);\n      }\n    });\n  };\n\n  const renderOptions = (cartItemQuantity) => {\n    const options = [];\n\n    for (let i = 1; i <= 20; i++) {\n      options.push(\n        <option value={i} key={[i]}>\n          Qty: {i}\n        </option>\n      );\n    }\n    return options;\n  };\n\n  const onChange = (e) => {\n    refs.forEach((ref) => {\n      if (\n        ref.current.getAttribute(\"value\") ===\n        e.target.getAttribute(\"data-select\")\n      ) {\n        updateQuantity({\n          _id: ref.current.getAttribute(\"id\"),\n          id: +ref.current.getAttribute(\"value\"),\n          quantity: +e.target.value,\n        });\n        console.log(ref.current.getAttribute(\"id\"));\n      }\n    });\n  };\n\n  const renderItems = () => {\n    return cart.map((cartItem, i) => {\n      return (\n        <div\n          id={cartItem._id}\n          ref={refs[i]}\n          key={cartItem.id}\n          value={cartItem.id}\n          className='cart-card'>\n          <img className='cart-card__img' src={cartItem.image} alt='' />\n          <div className='cart-card__body'>\n            <h5 className='cart-card__title'>{cartItem.title}</h5>\n            <h1>${cartItem.price}</h1>\n            <div className='cart-card__button-group'>\n              <form>\n                <select\n                  onChange={(e) => onChange(e)}\n                  defaultValue={cartItem.quantity}\n                  data-select={cartItem.id}\n                  name='Quantity'>\n                  {renderOptions(cartItem.quantity)}\n                </select>\n              </form>\n              <span\n                onClick={deleteFromCart}\n                data-delete={cartItem.id}\n                className='cart-card__button-group-btn ml-1'>\n                Delete Item\n              </span>\n            </div>\n          </div>\n        </div>\n      );\n    });\n  };\n\n  const emptyCart = () => {\n    return <div className='flex-center'>Your shopping cart is empty</div>;\n  };\n\n  return (\n    <Fragment>\n      {grandTotal === 0 ? (\n        <Fragment>{emptyCart()}</Fragment>\n      ) : (\n        <div className='shopping-cart-card-container mb-1'>\n          <h1 className='shopping-cart-title'>Shopping Cart</h1>\n          {renderItems()}\n          <h1 className='subtotal ml-a'>Subtotal: ${grandTotal}</h1>\n        </div>\n      )}\n    </Fragment>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    cart: state.cartItems.cart,\n    isAuthenticated: state.authUser.isAuthenticated,\n  };\n};\n\nexport default connect(mapStateToProps, {\n  removeProductFromCart,\n  updateQuantity,\n  loadUserCart,\n})(ShoppingCartCard);\n"]},"metadata":{},"sourceType":"module"}